<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fit & FIRM REHAB TEAM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Kanit', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 25%, #4c1d95 50%, #6b21a8 75%, #7c3aed 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        .floating-emoji {
            position: absolute;
            font-size: 2rem;
            opacity: 0.1;
            animation: float 6s ease-in-out infinite;
            pointer-events: none;
        }
        
        .floating-emoji:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; }
        .floating-emoji:nth-child(2) { top: 20%; right: 15%; animation-delay: 1s; }
        .floating-emoji:nth-child(3) { top: 40%; left: 5%; animation-delay: 2s; }
        .floating-emoji:nth-child(4) { top: 60%; right: 10%; animation-delay: 3s; }
        .floating-emoji:nth-child(5) { top: 80%; left: 20%; animation-delay: 4s; }
        .floating-emoji:nth-child(6) { top: 30%; left: 50%; animation-delay: 1.5s; }
        .floating-emoji:nth-child(7) { top: 70%; right: 30%; animation-delay: 2.5s; }
        .floating-emoji:nth-child(8) { top: 15%; right: 40%; animation-delay: 3.5s; }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-20px) rotate(5deg); }
            50% { transform: translateY(-10px) rotate(-5deg); }
            75% { transform: translateY(-15px) rotate(3deg); }
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.1);
        }
        
        .tab-active {
            background: linear-gradient(135deg, #7c3aed, #a855f7);
            color: white;
            box-shadow: 0 10px 25px rgba(124, 58, 237, 0.3);
        }
        
        .tab-inactive {
            background: rgba(255, 255, 255, 0.9);
            color: #7c3aed;
            border: 2px solid #a855f7;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #7c3aed, #a855f7);
            box-shadow: 0 10px 25px rgba(124, 58, 237, 0.3);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #6d28d9, #9333ea);
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(124, 58, 237, 0.4);
        }
        
        .loading-spinner {
            border: 3px solid rgba(124, 58, 237, 0.3);
            border-top: 3px solid #7c3aed;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .success-animation {
            animation: bounce 0.6s ease-in-out;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .upload-area {
            border: 2px dashed #a855f7;
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.05), rgba(168, 85, 247, 0.05));
            transition: all 0.3s ease;
        }
        
        .upload-area:hover {
            border-color: #7c3aed;
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), rgba(168, 85, 247, 0.1));
        }
        
        .ranking-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9));
            backdrop-filter: blur(20px);
            border-left: 4px solid;
        }
        
        .ranking-gold { border-left-color: #fbbf24; }
        .ranking-blue { border-left-color: #3b82f6; }
        .ranking-green { border-left-color: #10b981; }
        
        @media (max-width: 768px) {
            .floating-emoji {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body class="gradient-bg">
    <!-- Floating Emojis -->
    <div class="floating-emoji">üí™</div>
    <div class="floating-emoji">üèÉ‚Äç‚ôÇÔ∏è</div>
    <div class="floating-emoji">‚≠ê</div>
    <div class="floating-emoji">üéØ</div>
    <div class="floating-emoji">üèÜ</div>
    <div class="floating-emoji">üí™</div>
    <div class="floating-emoji">üèÉ‚Äç‚ôÄÔ∏è</div>
    <div class="floating-emoji">‚≠ê</div>

    <!-- Header -->
    <div class="glass-card">
        <div class="max-w-4xl mx-auto px-4 py-6">
            <div class="text-center">
                <h1 class="text-2xl md:text-3xl font-bold text-purple-700 mb-2">
                    <i class="fas fa-heartbeat mr-2"></i>
                    Fit & FIRM REHAB TEAM
                </h1>
                <p class="text-purple-600 text-sm md:text-base">‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</p>
            </div>
        </div>
    </div>

    <!-- Tab Navigation -->
    <div class="max-w-4xl mx-auto px-4 py-6">
        <div class="flex rounded-xl overflow-hidden glass-card mb-6">
            <button id="recordTab" class="flex-1 py-3 px-4 font-medium transition-all duration-300 tab-active rounded-l-xl">
                <i class="fas fa-edit mr-2"></i>
                <span class="hidden sm:inline">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                <span class="sm:hidden">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span>
            </button>
            <button id="summaryTab" class="flex-1 py-3 px-4 font-medium transition-all duration-300 tab-inactive">
                <i class="fas fa-chart-bar mr-2"></i>
                <span class="hidden sm:inline">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                <span class="sm:hidden">‡∏™‡∏£‡∏∏‡∏õ</span>
            </button>
            <button id="rankingTab" class="flex-1 py-3 px-4 font-medium transition-all duration-300 tab-inactive rounded-r-xl">
                <i class="fas fa-trophy mr-2"></i>
                <span class="hidden sm:inline">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>
                <span class="sm:hidden">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</span>
            </button>
        </div>

        <!-- Record Tab Content -->
        <div id="recordContent" class="glass-card rounded-xl p-6">
            <form id="recordForm" class="space-y-6">
                <!-- Name Selection -->
                <div>
                    <label class="block text-purple-700 font-medium mb-2">
                        <i class="fas fa-user mr-2"></i>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠
                    </label>
                    <select id="nameSelect" class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors bg-white">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ --</option>
                        <option value="‡∏ß‡∏≤‡∏£‡∏µ‡∏£‡∏±‡∏ï‡∏ô‡πå">‡∏ß‡∏≤‡∏£‡∏µ‡∏£‡∏±‡∏ï‡∏ô‡πå</option>
                        <option value="‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏à">‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏à</option>
                        <option value="‡∏™‡∏∏‡∏û‡∏±‡∏ï‡∏£‡∏≤">‡∏™‡∏∏‡∏û‡∏±‡∏ï‡∏£‡∏≤</option>
                        <option value="‡∏ê‡∏¥‡∏ï‡∏¥‡∏°‡∏≤">‡∏ê‡∏¥‡∏ï‡∏¥‡∏°‡∏≤</option>
                        <option value="‡∏≠‡∏∏‡∏°‡∏≤‡∏û‡∏£">‡∏≠‡∏∏‡∏°‡∏≤‡∏û‡∏£</option>
                        <option value="‡πÄ‡∏≠‡∏Å‡∏ò‡∏ô‡∏±‡∏ä">‡πÄ‡∏≠‡∏Å‡∏ò‡∏ô‡∏±‡∏ä</option>
                        <option value="‡∏à‡∏¥‡∏£‡∏û‡∏á‡∏®‡πå">‡∏à‡∏¥‡∏£‡∏û‡∏á‡∏®‡πå</option>
                        <option value="‡∏ô‡∏¥‡∏™‡∏≤">‡∏ô‡∏¥‡∏™‡∏≤</option>
                        <option value="‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏≤">‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏≤</option>
                        <option value="‡πÑ‡∏û‡πÇ‡∏£‡∏à‡∏ô‡πå">‡πÑ‡∏û‡πÇ‡∏£‡∏à‡∏ô‡πå</option>
                        <option value="‡∏≠‡∏£‡∏£‡∏ñ‡∏û‡∏•">‡∏≠‡∏£‡∏£‡∏ñ‡∏û‡∏•</option>
                        <option value="‡∏°‡∏ì‡∏ë‡∏≤">‡∏°‡∏ì‡∏ë‡∏≤</option>
                    </select>
                </div>

                <!-- Date Selection -->
                <div>
                    <label class="block text-purple-700 font-medium mb-2">
                        <i class="fas fa-calendar mr-2"></i>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
                    </label>
                    <input type="date" id="dateSelect" class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors bg-white">
                </div>

                <!-- Exercise Activity Image -->
                <div>
                    <label class="block text-purple-700 font-medium mb-2">
                        <i class="fas fa-dumbbell mr-2"></i>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢
                    </label>
                    <div class="upload-area rounded-lg p-6 text-center">
                        <input type="file" id="exerciseImage" accept="image/*" class="hidden">
                        <button type="button" id="exerciseUploadBtn" onclick="document.getElementById('exerciseImage').click()" class="w-full">
                            <i class="fas fa-cloud-upload-alt text-4xl text-purple-500 mb-2"></i>
                            <p class="text-purple-700 font-medium">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</p>
                            <p class="text-purple-500 text-sm mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå JPG, PNG, GIF (‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î)</p>
                        </button>
                        <div id="exercisePreview" class="mt-4 hidden">
                            <img id="exerciseImg" class="max-w-full h-32 object-cover rounded-lg mx-auto border-2 border-purple-200">
                            <p id="exerciseFileName" class="text-sm text-purple-600 mt-2"></p>
                            <button type="button" id="deleteExerciseBtn" class="mt-2 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                                <i class="fas fa-trash mr-1"></i>‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Health Credit Image -->
                <div>
                    <label class="block text-purple-700 font-medium mb-2">
                        <i class="fas fa-award mr-2"></i>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Siriraj Health Credit
                    </label>
                    <div class="upload-area rounded-lg p-6 text-center">
                        <input type="file" id="healthImage" accept="image/*" class="hidden">
                        <button type="button" id="healthUploadBtn" onclick="document.getElementById('healthImage').click()" class="w-full">
                            <i class="fas fa-cloud-upload-alt text-4xl text-purple-500 mb-2"></i>
                            <p class="text-purple-700 font-medium">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</p>
                            <p class="text-purple-500 text-sm mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå JPG, PNG, GIF (‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î)</p>
                        </button>
                        <div id="healthPreview" class="mt-4 hidden">
                            <img id="healthImg" class="max-w-full h-32 object-cover rounded-lg mx-auto border-2 border-purple-200">
                            <p id="healthFileName" class="text-sm text-purple-600 mt-2"></p>
                            <button type="button" id="deleteHealthBtn" class="mt-2 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                                <i class="fas fa-trash mr-1"></i>‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" id="submitBtn" class="w-full btn-primary text-white py-4 px-6 rounded-lg font-medium text-lg">
                    <i class="fas fa-save mr-2"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>

                <!-- Loading State -->
                <div id="loadingState" class="hidden text-center py-4">
                    <div class="loading-spinner mx-auto mb-2"></div>
                    <p class="text-purple-700 font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>

                <!-- Success State -->
                <div id="successState" class="hidden text-center py-4 success-animation">
                    <i class="fas fa-check-circle text-5xl text-green-500 mb-2"></i>
                    <p class="text-green-600 font-medium text-lg">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</p>
                </div>
            </form>
        </div>

        <!-- Summary Tab Content -->
        <div id="summaryContent" class="hidden glass-card rounded-xl p-6">
            <div class="space-y-6">
                <!-- Filter Section -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-purple-700 font-medium mb-2">
                            <i class="fas fa-user mr-2"></i>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠
                        </label>
                        <select id="summaryName" class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none bg-white">
                            <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                            <option value="‡∏ß‡∏≤‡∏£‡∏µ‡∏£‡∏±‡∏ï‡∏ô‡πå">‡∏ß‡∏≤‡∏£‡∏µ‡∏£‡∏±‡∏ï‡∏ô‡πå</option>
                            <option value="‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏à">‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏à</option>
                            <option value="‡∏™‡∏∏‡∏û‡∏±‡∏ï‡∏£‡∏≤">‡∏™‡∏∏‡∏û‡∏±‡∏ï‡∏£‡∏≤</option>
                            <option value="‡∏ê‡∏¥‡∏ï‡∏¥‡∏°‡∏≤">‡∏ê‡∏¥‡∏ï‡∏¥‡∏°‡∏≤</option>
                            <option value="‡∏≠‡∏∏‡∏°‡∏≤‡∏û‡∏£">‡∏≠‡∏∏‡∏°‡∏≤‡∏û‡∏£</option>
                            <option value="‡πÄ‡∏≠‡∏Å‡∏ò‡∏ô‡∏±‡∏ä">‡πÄ‡∏≠‡∏Å‡∏ò‡∏ô‡∏±‡∏ä</option>
                            <option value="‡∏à‡∏¥‡∏£‡∏û‡∏á‡∏®‡πå">‡∏à‡∏¥‡∏£‡∏û‡∏á‡∏®‡πå</option>
                            <option value="‡∏ô‡∏¥‡∏™‡∏≤">‡∏ô‡∏¥‡∏™‡∏≤</option>
                            <option value="‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏≤">‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏≤</option>
                            <option value="‡πÑ‡∏û‡πÇ‡∏£‡∏à‡∏ô‡πå">‡πÑ‡∏û‡πÇ‡∏£‡∏à‡∏ô‡πå</option>
                            <option value="‡∏≠‡∏£‡∏£‡∏ñ‡∏û‡∏•">‡∏≠‡∏£‡∏£‡∏ñ‡∏û‡∏•</option>
                            <option value="‡∏°‡∏ì‡∏ë‡∏≤">‡∏°‡∏ì‡∏ë‡∏≤</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-purple-700 font-medium mb-2">
                            <i class="fas fa-calendar mr-2"></i>‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                        </label>
                        <input type="month" id="fromMonth" class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none bg-white">
                    </div>
                    <div>
                        <label class="block text-purple-700 font-medium mb-2">
                            <i class="fas fa-calendar mr-2"></i>‡∏ñ‡∏∂‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                        </label>
                        <input type="month" id="toMonth" class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none bg-white">
                    </div>
                </div>

                <!-- Search Button -->
                <button id="searchBtn" class="w-full md:w-auto btn-primary text-white py-3 px-8 rounded-lg font-medium">
                    <i class="fas fa-search mr-2"></i>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>

                <!-- Summary Cards -->
                <div id="summaryCards" class="grid grid-cols-1 md:grid-cols-3 gap-6 hidden">
                    <div class="ranking-card ranking-blue p-6 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-dumbbell text-3xl text-blue-500 mr-4"></i>
                            <div>
                                <p class="text-blue-600 font-medium">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</p>
                                <p id="exerciseCount" class="text-2xl font-bold text-blue-700">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="ranking-card ranking-green p-6 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-award text-3xl text-green-500 mr-4"></i>
                            <div>
                                <p class="text-green-600 font-medium">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Health Credit</p>
                                <p id="healthCount" class="text-2xl font-bold text-green-700">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="ranking-card ranking-gold p-6 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-chart-line text-3xl text-yellow-500 mr-4"></i>
                            <div>
                                <p class="text-yellow-600 font-medium">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                                <p id="totalCount" class="text-2xl font-bold text-yellow-700">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Table -->
                <div id="dataTable" class="hidden overflow-x-auto">
                    <table class="w-full border-collapse bg-white rounded-lg overflow-hidden shadow-lg">
                        <thead class="btn-primary text-white">
                            <tr>
                                <th class="p-3 text-left">‡∏ä‡∏∑‡πà‡∏≠</th>
                                <th class="p-3 text-left">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th class="p-3 text-center">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</th>
                                <th class="p-3 text-center">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                        </tbody>
                    </table>
                </div>

                <!-- Loading State for Summary -->
                <div id="summaryLoading" class="hidden text-center py-8">
                    <div class="loading-spinner mx-auto mb-2"></div>
                    <p class="text-purple-700 font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>
            </div>
        </div>

        <!-- Ranking Tab Content -->
        <div id="rankingContent" class="hidden glass-card rounded-xl p-6">
            <div class="space-y-6">
                <!-- Show Ranking Button -->
                <div class="text-center">
                    <button id="showRankingBtn" class="btn-primary text-white py-3 px-8 rounded-lg font-medium">
                        <i class="fas fa-trophy mr-2"></i>‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                    </button>
                </div>

                <!-- Loading State for Ranking -->
                <div id="rankingLoading" class="hidden text-center py-8">
                    <div class="loading-spinner mx-auto mb-2"></div>
                    <p class="text-purple-700 font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö...</p>
                </div>

                <!-- Ranking Results -->
                <div id="rankingResults" class="hidden space-y-6">
                    <!-- Total Score Ranking -->
                    <div class="ranking-card ranking-gold p-6 rounded-lg">
                        <h3 class="text-xl font-bold text-yellow-700 mb-4 flex items-center">
                            <i class="fas fa-crown mr-2"></i>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                        </h3>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b-2 border-yellow-300">
                                        <th class="text-left py-2 text-yellow-700">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
                                        <th class="text-left py-2 text-yellow-700">‡∏ä‡∏∑‡πà‡∏≠</th>
                                        <th class="text-center py-2 text-yellow-700">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</th>
                                        <th class="text-center py-2 text-yellow-700">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                                        <th class="text-center py-2 text-yellow-700">‡∏£‡∏ß‡∏°</th>
                                    </tr>
                                </thead>
                                <tbody id="totalRankingTable">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Exercise Ranking -->
                    <div class="ranking-card ranking-blue p-6 rounded-lg">
                        <h3 class="text-xl font-bold text-blue-700 mb-4 flex items-center">
                            <i class="fas fa-dumbbell mr-2"></i>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢
                        </h3>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b-2 border-blue-300">
                                        <th class="text-left py-2 text-blue-700">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
                                        <th class="text-left py-2 text-blue-700">‡∏ä‡∏∑‡πà‡∏≠</th>
                                        <th class="text-center py-2 text-blue-700">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                    </tr>
                                </thead>
                                <tbody id="exerciseRankingTable">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Health Credit Ranking -->
                    <div class="ranking-card ranking-green p-6 rounded-lg">
                        <h3 class="text-xl font-bold text-green-700 mb-4 flex items-center">
                            <i class="fas fa-award mr-2"></i>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Siriraj Health Credit
                        </h3>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b-2 border-green-300">
                                        <th class="text-left py-2 text-green-700">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
                                        <th class="text-left py-2 text-green-700">‡∏ä‡∏∑‡πà‡∏≠</th>
                                        <th class="text-center py-2 text-green-700">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                    </tr>
                                </thead>
                                <tbody id="healthRankingTable">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxYb5G3LIzYb1m1mCuw9suyewmpmECeFjoA4_Pw_2XePMFt1HGS4J94E22N7utKzilD/exec';
        let allData = [];

        // Tab switching
        document.getElementById('recordTab').addEventListener('click', () => switchTab('record'));
        document.getElementById('summaryTab').addEventListener('click', () => switchTab('summary'));
        document.getElementById('rankingTab').addEventListener('click', () => switchTab('ranking'));

        function switchTab(tab) {
            const recordTab = document.getElementById('recordTab');
            const summaryTab = document.getElementById('summaryTab');
            const rankingTab = document.getElementById('rankingTab');
            const recordContent = document.getElementById('recordContent');
            const summaryContent = document.getElementById('summaryContent');
            const rankingContent = document.getElementById('rankingContent');

            // Reset all tabs to inactive
            recordTab.className = recordTab.className.replace('tab-active', 'tab-inactive');
            summaryTab.className = summaryTab.className.replace('tab-active', 'tab-inactive');
            rankingTab.className = rankingTab.className.replace('tab-active', 'tab-inactive');

            // Hide all content
            recordContent.classList.add('hidden');
            summaryContent.classList.add('hidden');
            rankingContent.classList.add('hidden');

            if (tab === 'record') {
                recordTab.className = recordTab.className.replace('tab-inactive', 'tab-active');
                recordContent.classList.remove('hidden');
            } else if (tab === 'summary') {
                summaryTab.className = summaryTab.className.replace('tab-inactive', 'tab-active');
                summaryContent.classList.remove('hidden');
            } else if (tab === 'ranking') {
                rankingTab.className = rankingTab.className.replace('tab-inactive', 'tab-active');
                rankingContent.classList.remove('hidden');
            }
        }

        // File preview functionality with improved error handling
        function setupFilePreview(inputId, previewId, imgId, fileNameId, uploadBtnId) {
            const input = document.getElementById(inputId);
            const preview = document.getElementById(previewId);
            const img = document.getElementById(imgId);
            const fileName = document.getElementById(fileNameId);
            const uploadBtn = document.getElementById(uploadBtnId);

            input.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    // Validate file type
                    const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];
                    if (!validTypes.includes(file.type)) {
                        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (JPG, PNG, GIF) ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô');
                        input.value = '';
                        return;
                    }

                    // Validate file size (max 10MB)
                    if (file.size > 10 * 1024 * 1024) {
                        alert('‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB');
                        input.value = '';
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            img.src = e.target.result;
                            fileName.textContent = file.name;
                            preview.classList.remove('hidden');
                            uploadBtn.classList.add('hidden');
                        } catch (error) {
                            console.error('Error loading image:', error);
                            alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
                            input.value = '';
                        }
                    };
                    reader.onerror = function() {
                        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå');
                        input.value = '';
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        setupFilePreview('exerciseImage', 'exercisePreview', 'exerciseImg', 'exerciseFileName', 'exerciseUploadBtn');
        setupFilePreview('healthImage', 'healthPreview', 'healthImg', 'healthFileName', 'healthUploadBtn');

        // Delete image functionality
        document.getElementById('deleteExerciseBtn').addEventListener('click', function() {
            document.getElementById('exerciseImage').value = '';
            document.getElementById('exercisePreview').classList.add('hidden');
            document.getElementById('exerciseImg').src = '';
            document.getElementById('exerciseFileName').textContent = '';
            document.getElementById('exerciseUploadBtn').classList.remove('hidden');
        });

        document.getElementById('deleteHealthBtn').addEventListener('click', function() {
            document.getElementById('healthImage').value = '';
            document.getElementById('healthPreview').classList.add('hidden');
            document.getElementById('healthImg').src = '';
            document.getElementById('healthFileName').textContent = '';
            document.getElementById('healthUploadBtn').classList.remove('hidden');
        });

        // Convert file to base64 with error handling
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                if (!file) {
                    reject(new Error('No file provided'));
                    return;
                }
                
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => {
                    try {
                        const result = reader.result;
                        if (result && typeof result === 'string') {
                            resolve(result.split(',')[1]);
                        } else {
                            reject(new Error('Invalid file data'));
                        }
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = error => reject(error);
            });
        }

        // Set default date to today
        document.getElementById('dateSelect').valueAsDate = new Date();

        // Form submission with improved error handling
        document.getElementById('recordForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('nameSelect').value;
            const date = document.getElementById('dateSelect').value;
            const exerciseFile = document.getElementById('exerciseImage').files[0];
            const healthFile = document.getElementById('healthImage').files[0];

            if (!name || !date) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà');
                return;
            }

            if (!exerciseFile && !healthFile) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏π‡∏õ');
                return;
            }

            // Show loading state
            document.getElementById('submitBtn').classList.add('hidden');
            document.getElementById('loadingState').classList.remove('hidden');

            try {
                const formData = new URLSearchParams();
                formData.append('action', 'saveData');
                formData.append('name', name);
                formData.append('date', date);

                if (exerciseFile) {
                    try {
                        const exerciseBase64 = await fileToBase64(exerciseFile);
                        formData.append('exerciseImage', exerciseBase64);
                        formData.append('exerciseFileName', exerciseFile.name);
                        formData.append('exerciseMimeType', exerciseFile.type);
                    } catch (error) {
                        throw new Error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°');
                    }
                }

                if (healthFile) {
                    try {
                        const healthBase64 = await fileToBase64(healthFile);
                        formData.append('healthImage', healthBase64);
                        formData.append('healthFileName', healthFile.name);
                        formData.append('healthMimeType', healthFile.type);
                    } catch (error) {
                        throw new Error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô');
                    }
                }

                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const result = await response.json();

                if (result.success) {
                    // Show success state
                    document.getElementById('loadingState').classList.add('hidden');
                    document.getElementById('successState').classList.remove('hidden');
                    
                    // Reset form after 2 seconds
                    setTimeout(() => {
                        document.getElementById('recordForm').reset();
                        document.getElementById('exercisePreview').classList.add('hidden');
                        document.getElementById('healthPreview').classList.add('hidden');
                        document.getElementById('exerciseUploadBtn').classList.remove('hidden');
                        document.getElementById('healthUploadBtn').classList.remove('hidden');
                        document.getElementById('successState').classList.add('hidden');
                        document.getElementById('submitBtn').classList.remove('hidden');
                        document.getElementById('dateSelect').valueAsDate = new Date();
                    }, 2000);
                } else {
                    throw new Error(result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('submitBtn').classList.remove('hidden');
            }
        });

        // Search functionality
        document.getElementById('searchBtn').addEventListener('click', async function() {
            const name = document.getElementById('summaryName').value;
            const fromMonth = document.getElementById('fromMonth').value;
            const toMonth = document.getElementById('toMonth').value;

            // Show loading
            document.getElementById('summaryLoading').classList.remove('hidden');
            document.getElementById('summaryCards').classList.add('hidden');
            document.getElementById('dataTable').classList.add('hidden');

            try {
                const formData = new URLSearchParams();
                formData.append('action', 'getData');
                if (name) formData.append('name', name);
                if (fromMonth) formData.append('fromMonth', fromMonth);
                if (toMonth) formData.append('toMonth', toMonth);

                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    allData = result.data;
                    displaySummary(allData);
                } else {
                    throw new Error(result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            } finally {
                document.getElementById('summaryLoading').classList.add('hidden');
            }
        });

        function displaySummary(data) {
            let exerciseCount = 0;
            let healthCount = 0;

            data.forEach(row => {
                if (row.exerciseImageUrl) exerciseCount++;
                if (row.healthImageUrl) healthCount++;
            });

            document.getElementById('exerciseCount').textContent = exerciseCount;
            document.getElementById('healthCount').textContent = healthCount;
            document.getElementById('totalCount').textContent = exerciseCount + healthCount;

            // Show summary cards
            document.getElementById('summaryCards').classList.remove('hidden');

            // Display table
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';

            data.forEach(row => {
                const tr = document.createElement('tr');
                tr.className = 'border-b hover:bg-purple-50 transition-colors';
                tr.innerHTML = `
                    <td class="p-3 font-medium">${row.name}</td>
                    <td class="p-3">${new Date(row.date).toLocaleDateString('th-TH')}</td>
                    <td class="p-3 text-center">
                        ${row.exerciseImageUrl ? '<i class="fas fa-check text-green-500"></i>' : '<i class="fas fa-times text-red-500"></i>'}
                    </td>
                    <td class="p-3 text-center">
                        ${row.healthImageUrl ? '<i class="fas fa-check text-green-500"></i>' : '<i class="fas fa-times text-red-500"></i>'}
                    </td>
                `;
                tableBody.appendChild(tr);
            });

            document.getElementById('dataTable').classList.remove('hidden');
        }

        // Set default month range
        const now = new Date();
        const currentMonth = now.getFullYear() + '-' + String(now.getMonth() + 1).padStart(2, '0');
        document.getElementById('fromMonth').value = currentMonth;
        document.getElementById('toMonth').value = currentMonth;

        // Ranking functionality
        document.getElementById('showRankingBtn').addEventListener('click', async function() {
            // Show loading
            document.getElementById('rankingLoading').classList.remove('hidden');
            document.getElementById('rankingResults').classList.add('hidden');

            try {
                const formData = new URLSearchParams();
                formData.append('action', 'getData');

                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    calculateAndDisplayRanking(result.data);
                } else {
                    throw new Error(result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            } finally {
                document.getElementById('rankingLoading').classList.add('hidden');
            }
        });

        function calculateAndDisplayRanking(data) {
            // All team members in alphabetical order (Thai)
            const allMembers = [
                '‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏≤', '‡∏≠‡∏£‡∏£‡∏ñ‡∏û‡∏•', '‡∏≠‡∏∏‡∏°‡∏≤‡∏û‡∏£', '‡πÄ‡∏≠‡∏Å‡∏ò‡∏ô‡∏±‡∏ä', '‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏à', 
                '‡∏ê‡∏¥‡∏ï‡∏¥‡∏°‡∏≤', '‡∏ô‡∏¥‡∏™‡∏≤', '‡πÑ‡∏û‡πÇ‡∏£‡∏à‡∏ô‡πå', '‡∏°‡∏ì‡∏ë‡∏≤', '‡∏ß‡∏≤‡∏£‡∏µ‡∏£‡∏±‡∏ï‡∏ô‡πå', 
                '‡∏™‡∏∏‡∏û‡∏±‡∏ï‡∏£‡∏≤', '‡∏à‡∏¥‡∏£‡∏û‡∏á‡∏®‡πå'
            ];

            // Calculate scores for each member
            const memberStats = {};
            
            // Initialize all members with zero scores
            allMembers.forEach(name => {
                memberStats[name] = {
                    exercise: 0,
                    health: 0,
                    total: 0
                };
            });

            // Count actual scores from data
            data.forEach(row => {
                if (memberStats[row.name]) {
                    if (row.exerciseImageUrl) memberStats[row.name].exercise++;
                    if (row.healthImageUrl) memberStats[row.name].health++;
                    memberStats[row.name].total = memberStats[row.name].exercise + memberStats[row.name].health;
                }
            });

            // Create ranking arrays
            const totalRanking = allMembers.map(name => ({
                name,
                exercise: memberStats[name].exercise,
                health: memberStats[name].health,
                total: memberStats[name].total
            })).sort((a, b) => {
                if (b.total !== a.total) return b.total - a.total;
                return a.name.localeCompare(b.name, 'th');
            });

            const exerciseRanking = allMembers.map(name => ({
                name,
                count: memberStats[name].exercise
            })).sort((a, b) => {
                if (b.count !== a.count) return b.count - a.count;
                return a.name.localeCompare(b.name, 'th');
            });

            const healthRanking = allMembers.map(name => ({
                name,
                count: memberStats[name].health
            })).sort((a, b) => {
                if (b.count !== a.count) return b.count - a.count;
                return a.name.localeCompare(b.name, 'th');
            });

            // Display rankings
            displayTotalRanking(totalRanking);
            displayExerciseRanking(exerciseRanking);
            displayHealthRanking(healthRanking);

            document.getElementById('rankingResults').classList.remove('hidden');
        }

        function displayTotalRanking(ranking) {
            const tbody = document.getElementById('totalRankingTable');
            tbody.innerHTML = '';

            ranking.forEach((member, index) => {
                const rank = index + 1;
                const tr = document.createElement('tr');
                tr.className = 'border-b hover:bg-yellow-50 transition-colors';
                
                let rankIcon = '';
                if (rank === 1) rankIcon = '<i class="fas fa-crown text-yellow-500 mr-1"></i>';
                else if (rank === 2) rankIcon = '<i class="fas fa-medal text-gray-400 mr-1"></i>';
                else if (rank === 3) rankIcon = '<i class="fas fa-medal text-orange-400 mr-1"></i>';

                tr.innerHTML = `
                    <td class="py-2 font-bold text-yellow-700">${rankIcon}${rank}</td>
                    <td class="py-2 font-medium">${member.name}</td>
                    <td class="py-2 text-center">${member.exercise}</td>
                    <td class="py-2 text-center">${member.health}</td>
                    <td class="py-2 text-center font-bold text-yellow-700">${member.total}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function displayExerciseRanking(ranking) {
            const tbody = document.getElementById('exerciseRankingTable');
            tbody.innerHTML = '';

            ranking.forEach((member, index) => {
                const rank = index + 1;
                const tr = document.createElement('tr');
                tr.className = 'border-b hover:bg-blue-50 transition-colors';
                
                let rankIcon = '';
                if (rank === 1) rankIcon = '<i class="fas fa-crown text-yellow-500 mr-1"></i>';
                else if (rank === 2) rankIcon = '<i class="fas fa-medal text-gray-400 mr-1"></i>';
                else if (rank === 3) rankIcon = '<i class="fas fa-medal text-orange-400 mr-1"></i>';

                tr.innerHTML = `
                    <td class="py-2 font-bold text-blue-700">${rankIcon}${rank}</td>
                    <td class="py-2 font-medium">${member.name}</td>
                    <td class="py-2 text-center font-bold text-blue-700">${member.count}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function displayHealthRanking(ranking) {
            const tbody = document.getElementById('healthRankingTable');
            tbody.innerHTML = '';

            ranking.forEach((member, index) => {
                const rank = index + 1;
                const tr = document.createElement('tr');
                tr.className = 'border-b hover:bg-green-50 transition-colors';
                
                let rankIcon = '';
                if (rank === 1) rankIcon = '<i class="fas fa-crown text-yellow-500 mr-1"></i>';
                else if (rank === 2) rankIcon = '<i class="fas fa-medal text-gray-400 mr-1"></i>';
                else if (rank === 3) rankIcon = '<i class="fas fa-medal text-orange-400 mr-1"></i>';

                tr.innerHTML = `
                    <td class="py-2 font-bold text-green-700">${rankIcon}${rank}</td>
                    <td class="py-2 font-medium">${member.name}</td>
                    <td class="py-2 text-center font-bold text-green-700">${member.count}</td>
                `;
                tbody.appendChild(tr);
            });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96a747a926c0ce9b',t:'MTc1NDQwNzI0MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
